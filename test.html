<!DOCTYPE html>
<html>
<head>
    <title>Kitchen Designer - Test Console</title>
    <style>
        body { font-family: monospace; padding: 20px; background: #f5f5f5; }
        .test-section { background: white; padding: 20px; margin: 10px 0; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); }
        .pass { color: green; font-weight: bold; }
        .fail { color: red; font-weight: bold; }
        .test-item { padding: 10px; margin: 5px 0; border-left: 4px solid #ddd; }
        .test-item.pass { border-left-color: green; background: #f0fff0; }
        .test-item.fail { border-left-color: red; background: #fff0f0; }
        iframe { width: 100%; height: 800px; border: none; border-radius: 8px; }
    </style>
</head>
<body>
    <h1>ðŸ§ª Kitchen Designer - Functionality Test</h1>
    
    <div class="test-section">
        <h2>Test Results</h2>
        <div id="results"></div>
    </div>

    <div class="test-section">
        <h2>Live Preview</h2>
        <iframe src="index.html"></iframe>
    </div>

    <script>
        const tests = [
            {
                name: 'Canvas Element Exists',
                test: () => {
                    const iframe = document.querySelector('iframe');
                    return iframe && iframe.contentDocument && iframe.contentDocument.getElementById('kitchenCanvas') !== null;
                }
            },
            {
                name: 'All UI Controls Present',
                test: () => {
                    const iframe = document.querySelector('iframe');
                    const doc = iframe.contentDocument;
                    const controls = [
                        'cabinetStyle',
                        'countertop',
                        'backsplash',
                        'flooring',
                        'brightness',
                        'contrast',
                        'islandToggle',
                        'backsplashToggle',
                        'exportBtn',
                        'shareBtn',
                        'resetDesignBtn',
                        'aiSuggestBtn'
                    ];
                    return controls.every(id => doc.getElementById(id) !== null);
                }
            },
            {
                name: 'Color Swatches Exist',
                test: () => {
                    const iframe = document.querySelector('iframe');
                    const doc = iframe.contentDocument;
                    const swatches = doc.querySelectorAll('[data-cabinet-color]');
                    return swatches.length > 0;
                }
            },
            {
                name: 'Design State Object',
                test: () => {
                    const iframe = document.querySelector('iframe');
                    return iframe.contentWindow.renderer && iframe.contentWindow.renderer.design;
                }
            },
            {
                name: 'Render Method Working',
                test: () => {
                    const iframe = document.querySelector('iframe');
                    return typeof iframe.contentWindow.renderer.render === 'function';
                }
            },
            {
                name: 'AI Assistant Available',
                test: () => {
                    const iframe = document.querySelector('iframe');
                    return iframe.contentWindow.aiAssistant !== undefined;
                }
            }
        ];

        async function runTests() {
            const resultsDiv = document.getElementById('results');
            resultsDiv.innerHTML = '<p>Running tests...</p>';

            // Wait for iframe to load
            await new Promise(resolve => {
                const iframe = document.querySelector('iframe');
                iframe.onload = resolve;
                if (iframe.contentDocument && iframe.contentDocument.readyState === 'complete') {
                    resolve();
                }
            });

            // Additional wait for JavaScript initialization
            await new Promise(resolve => setTimeout(resolve, 1000));

            let html = '';
            let passCount = 0;
            let failCount = 0;

            for (const t of tests) {
                let passed = false;
                let error = '';
                try {
                    passed = t.test();
                } catch (e) {
                    error = e.message;
                }

                if (passed) {
                    passCount++;
                    html += `<div class="test-item pass">âœ“ ${t.name}</div>`;
                } else {
                    failCount++;
                    html += `<div class="test-item fail">âœ— ${t.name}${error ? ': ' + error : ''}</div>`;
                }
            }

            html += `<div style="margin-top: 20px; padding: 10px; background: #f0f0f0; border-radius: 4px;">
                <strong>Results: </strong>
                <span class="pass">${passCount} passed</span> / 
                <span class="fail">${failCount} failed</span>
            </div>`;

            resultsDiv.innerHTML = html;
        }

        window.addEventListener('load', runTests);
    </script>
</body>
</html>
